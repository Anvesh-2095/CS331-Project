from soar.normalization import normalize_alert


def main():
    x = [
        {
            "tool": "SIEM",
            "alert_id": "SIEM-991",
            "timestamp": "2026-02-08T14:10:00Z",
            "severity": 8,
            "rule_name": "Multiple Failed Logins",
            "source_ip": "10.0.0.5",
            "destination_ip": "10.0.0.10",
            "username": "admin",
            "hostname": "prod-server-1",
            "description": "Brute force attempt detected",
        },
        {
            "tool": "Firewall",
            "log_id": "FW-201",
            "time": 1707390000,
            "risk": "high",
            "action": "deny",
            "src_ip": "192.168.1.15",
            "dst_ip": "10.0.0.2",
            "details": "Blocked suspicious outbound traffic",
        },
    ]

    for a in x:
        n = normalize_alert(a)
        print(n.to_dict())


if __name__ == "__main__":
    main()
