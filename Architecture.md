# SOAR System Architecture

This document describes the microservices-based architecture of the SOAR (Security Orchestration, Automation, and Response) platform.

The system is designed using a modular microservices approach, where each service performs a specific responsibility. The services communicate through well-defined interfaces and a central message bus, allowing the system to be scalable, maintainable, and easy to test.

## Deployment Strategy

To ensure low latency and high availability, the complete platform is containerized and designed for **multi-region replication**. Rather than splitting services across regions, full replicas of the entire platform can be deployed in different geographic zones (e.g., US-East, AP-South) to serve local users closer to their location.

## Core Services

### 1. Alert Ingestion Service

This service is the entry point for the platform. It is responsible for receiving security alerts and notifications from real security tools or simulated sources. The service performs basic validation, normalizes the data formats, and publishes the events to the Brain service.

### 2. Brain Service (Context-Aware Decision Engine)

The Brain is the stateless orchestration engine. While it does not retain local session memory, it is **context-aware**.

* **Function:** It retrieves historical context (e.g., previous offenses by an IP) from the database before making decisions.
* **Logic:** It analyzes the alert severity, correlates it with past data, and triggers the appropriate Playbook. 

### 3. Playbook Service

The Playbook service manages the execution of predefined response workflows.

* **Function:** It receives a command from the Brain and executes steps sequentially.
* **Sync Actuation:** Currently, it interacts **synchronously** with the actuators for strict consistency in the lab, though the modular design permits a seamless transition to **asynchronous, event-driven actuation** in future high-scale iterations.

### 4. Notification Service

This service handles human communication. It is triggered when the SOAR platform cannot resolve an incident automatically or when a critical threshold is breached. It integrates with external communication tools (Email, Slack, Discord) to alert security analysts.

### 5. Artifact Recording Service (The Listener)

This service acts as a **passive listener** on the message bus.

* **Function:** It observes all traffic between the Ingestion, Brain, and Playbook services.
* **Benefit:** Instead of blocking the workflow, it asynchronously records every alert, decision, action, and outcome into the long-term storage (Audit Log). This ensures zero latency impact on the core remediation process while maintaining a perfect audit trail.

## Supporting and Simulated Services

### 6. Alert Simulation Service

This service generates mock security alerts (e.g., Phishing JSON objects) to validate the pipeline without requiring live malware or real attacks.

### 7. Actuator Simulation Service

This service mimics the behavior of real security tools (Firewalls, Active Directory, EDR).

* **Behavior:** It operates synchronously with the Playbook service to ensure deterministic testing.
* **Configurable Outcomes:** Users can configure it to simulate "Success" (IP Blocked) or "Failure" (Connection Timeout) to test how the Brain handles errors.

## Interaction Flow

1. **Ingest:** An alert is generated by the Alert Simulation Service. The Ingestion Service validates it and pushes it to the message bus.
2. **Archive:** The Artifact Recording Service immediately detects the new message and logs it.
3. **Decide:** The Brain Service picks up the alert, queries the DB for context, and selects a Playbook.
4. **Act:** The Playbook Service executes steps, making synchronous calls to the Actuator Simulation Service.
5. **Verify:** The Actuator returns a definite "Success/Fail" status to the Playbook, which reports back to the Brain.
6. **Resolve/Escalate:**
   * If successful, the Brain closes the ticket.
   * If failed, the Brain triggers the Notification Service.

## Architecture Benefits

* **Reliability:** Synchronous actuation ensures data consistency during demos.
* **Auditability:** The "Listener" pattern for artifacts ensures no data is lost, even if downstream services fail.
* **Scalability:** Stateless design allow the "Brain" and "Ingestion" services to scale horizontally across multiple instances.
* **Testability:** Decoupled simulations allow for safe, predictable "Red Team vs Blue Team" scenarios in a lab environment.

This architecture provides a robust, professional foundation for an automated security platform.